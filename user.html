<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Kitchen - Indian Foodie</title>
    <!-- ===== ICONS & CSS ===== -->
    <!-- Boxicons for UI icons -->
    <link href="https://unpkg.com/boxicons@latest/css/boxicons.min.css" rel="stylesheet">
    <!-- Main CSS stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- ===== HEADER / NAVBAR ===== -->
    <!-- Contains logo and navigation links with active page highlighting -->
    <header>
        <div class="container">
            <a href="index.html" class="logo">
                <img src="images/logo.png" alt="Indian Foodie Logo"> Indian Foodie
            </a>
            <nav class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="catering.html" class="nav-link">Catering</a>
                <a href="admin.html" class="nav-link">Admin</a>
                <a href="user.html" class="nav-link active-link">User</a>
                <!-- Logout button (hidden until logged in) -->
                <a href="#" id="logout-nav" class="nav-link" style="display:none;">üö™Logout</a>
            </nav>
        </div>
    </header>

    <!-- ===== MAIN USER SECTION ===== -->
    <main class="container user-container">
        <!-- === LOGIN & REGISTRATION AREA === -->
        <!-- Provides login and subscription forms for users -->
        <div id="auth-container">
            <h2>User Login</h2>
            <form id="login-form">
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Password" required>
                <button type="submit">üîëLogin to Order</button>
            </form>
            <hr>
            <h2>Subscribe To Our Service</h2>
            <form id="register-form">
                <input type="email" id="register-email" placeholder="Email" required>
                <input type="password" id="register-password" placeholder="Password" required>
                <button type="submit">üßë‚Äçü§ù‚ÄçüßëBe Our Customer</button>
            </form>
        </div>
        <!-- === USER DASHBOARD === -->
        <div id="user-panel" style="display:none;">
            <h1>My Culinary Dashboard</h1>
            <!-- === DASHBOARD TABS === -->
            <nav class="user-tabs">
                <button class="tab-btn active" data-section="profile">üë§ Profile User</button>
                <button class="tab-btn" data-section="upload">üì¶ Upload Product Details</button>
                <button class="tab-btn" data-section="orders">üßæ View Orders</button>
            </nav>
            <!-- === PROFILE SECTION === -->
            <section id="profile-section" class="tab-content active">
                <h2>My Profile</h2>
                <div id="profile-details"></div>
                <form id="profile-form" style="display:none;">
                    <input type="text" id="profile-name" placeholder="Full Name" required>
                    <input type="text" id="profile-address" placeholder="Address" required>
                    <button type="submit">Save Changes</button>
                </form>
                <button id="edit-profile-btn">Edit Profile</button>
            </section>
            <!-- === UPLOAD PRODUCT SECTION === -->
            <section id="upload-section" class="tab-content">
                <h2>Add a New Dish</h2>
                <form id="upload-form">
                    <input type="text" id="product-name" placeholder="Dish Name" required>
                    <textarea id="product-description" placeholder="Describe your dish" required></textarea>
                    <input type="number" id="product-price" placeholder="Price (in ‚Çπ)" required>
                    <input type="file" id="product-image" accept="image/*" required>
                    <button type="submit">Upload</button>
                </form>
                <div id="my-product-list"></div>
            </section>
            <!-- === ORDERS SECTION === -->
            <section id="orders-section" class="tab-content">
                <h2>My Orders</h2>
                <div id="order-list"></div>
            </section>
        </div>

    </main>

    <!-- ===== FOOTER ===== -->
    <!-- Includes brand info and social media links -->
    <footer>
        <div class="container footer-content">
            <a href="index.html" class="footer-link">
                <img src="images/logo.png" alt="Indian Foodie Logo">
                <p>&copy; 2025 Indian Foodie ‚Äî From Our Kitchen To Yours.</p>
            </a>
            <div class="footer-social">
                <a href="https://www.facebook.com/" target="_blank"><i class='bx bxl-facebook'></i></a>
                <a href="https://www.instagram.com/" target="_blank"><i class='bx bxl-instagram'></i></a>
                <a href="https://x.com/" target="_blank"><i class='bx bxl-twitter'></i></a>
            </div>
        </div>
    </footer>

    <!-- ===== SCRIPT SECTION ===== -->
    <script type="module">
        import { getApps, initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import {
            getAuth,
            onAuthStateChanged,
            signInWithEmailAndPassword,
            signOut,
            createUserWithEmailAndPassword,
        } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        import {
            getFirestore,
            doc,
            getDoc,
            setDoc,
            updateDoc,
            addDoc,
            deleteDoc,
            collection,
            getDocs,
            query,
            where,
            orderBy,
            serverTimestamp,
        } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCXk7V8qFm0Ym9fEAfqJsUBa5oZQVq2hO4",
            authDomain: "catering-reservation-ord-e2249.firebaseapp.com",
            projectId: "catering-reservation-ord-e2249",
            storageBucket: "catering-reservation-ord-e2249.firebasestorage.app",
            messagingSenderId: "536906317721",
            appId: "1:536906317721:web:c49a18f74270401016dd08",
        };

        // ‚úÖ FIX: Reuse existing Firebase app if already initialized
        const app = getApps().length ? getApps()[0] : initializeApp(firebaseConfig);

        const auth = getAuth(app);
        const db = getFirestore(app);

        // ‚úÖ Expose Firebase utilities globally
        window.firestore = {
            getFirestore,
            doc,
            getDoc,
            setDoc,
            updateDoc,
            addDoc,
            deleteDoc,
            collection,
            getDocs,
            query,
            where,
            orderBy,
            serverTimestamp,
        };

        window.auth = {
            getAuth: () => auth,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            createUserWithEmailAndPassword,
        };

        window.db = db;
    </script>

    <script>
        // simple tab switcher
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".tab-btn").forEach((btn) => {
                btn.addEventListener("click", () => {
                    // remove 'active' from all
                    document.querySelectorAll(".tab-btn, .tab-content").forEach(el => el.classList.remove("active"));
                    // add 'active' to clicked
                    btn.classList.add("active");
                    document.getElementById(`${btn.dataset.section}-section`).classList.add("active");
                });
            });
        });
    </script>

    <!-- Link JS -->
    <script src="user.js"></script>
</body>

</html>
